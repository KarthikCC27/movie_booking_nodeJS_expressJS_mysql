<html>
  <head>
    <title>login page</title>
  </head>
  <body>
    <form>
      <label>username:</label>
      <input type="text" id="username" required/>
      <br /><br />
      <label>password</label>
      <input type="password" id="password"  required/>
      <br /><br />
      <button type="button" onclick="loginUser()">login</button>
      <a href="signup">i'm a new user</a>
    </form>
    
  </body>

  <script>
    async function loginUser() {
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;
      const para = document.getElementById('para')
      let login_data = { user: username, pass: password };
      console.log(login_data)
      try {
        let response = await fetch("/login", {
          method: "POST",
          body: JSON.stringify({ login_data }),
          headers: { "Content-Type": "application/json" },
        });
        const access = response.ok
        if (response.ok) {
            const myresponse = await response.json()
            if(myresponse.resp=="ok"){
                window.location.href=`/index?username=${username}`
                console.log("access ok")
            }
            else{
                para.innerHTML="Invalid credentials";
            }  
        }
        else{
            console.log("Network Error")
        }

      } catch {
        (error) => {
          console.log("Error sending value", error);
        };
      }
    }
  </script>
</html>
